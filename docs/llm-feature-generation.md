# LLM. Генерация признаков

[Назад к списку компонентов](../README.md)

## Назначение

Компонент для автоматической генерации новых признаков (features) на основе анализа структуры и содержания входного набора данных. Для анализа содержания используется первая строка набора данных.

## Входные порты

| Название     | Тип        |
| :----------- | :--------- |
| Набор данных | Таблица    |
| Реквизиты    | Переменные |
| Параметры    | Переменные |
| Настройки    | Переменные |

### Структура таблицы "Набор данных"

На вход принимается набор данных любой структуры.

### Переменные в порте "Реквизиты"

| №   | Метка   | Тип                             | Значение по умолчанию |
| :-- | :------ | :------------------------------ | :-------------------- |
| 1   | url     | ![](./img/string.svg) Строковый | null                  |
| 2   | api_key | ![](./img/string.svg) Строковый | null                  |
| 3   | model   | ![](./img/string.svg) Строковый | null                  |

1. **url** — эндпоинт API чата LLM-сервиса.
2. **api_key** — API-ключ для аутентификации запросов.
3. **model** — идентификатор модели.

### Переменные в порте "Параметры"

| №   | Метка       | Тип                                    | Значение по умолчанию |
| :-- | :---------- | :------------------------------------- | :-------------------- |
| 1   | seed        | ![](./img/integer.svg) Целый           | 42                    |
| 2   | temperature | ![](./img/realnumber.svg) Вещественный | 0.7                   |

1. **seed** — параметр воспроизводимости ответа. По умолчанию `42`.
2. **temperature** — параметр, влияющий на случайность ответов (0-2). По умолчанию `0.7`.

### Переменные в порте "Настройки"

| №   | Метка                                    | Тип                               | Значение по умолчанию |
| :-- | :--------------------------------------- | :-------------------------------- | :-------------------- |
| 1   | Описание датасета                        | ![](./img/string.svg) Строковый   | null                  |
| 2   | Число признаков                          | ![](./img/integer.svg) Целый      | 5                     |
| 3   | Дополнительная инструкция                | ![](./img/string.svg) Строковый   | null                  |
| 4   | Путь к файлу                             | ![](./img/string.svg) Строковый   | /credentials          |
| 5   | Имя файла                                | ![](./img/string.svg) Строковый   | llm.params            |
| 6   | Использовать файл                        | ![](./img/logical.svg) Логический | true                  |
| 7   | Запрос к Ollama                          | ![](./img/logical.svg) Логический | false                 |
| 8   | Формировать кэш                          | ![](./img/logical.svg) Логический | true                  |
| 9   | Кэшированный ответ                       | ![](./img/logical.svg) Логический | false                 |
| 10  | Уникальный идентификатор кэша            | ![](./img/string.svg) Строковый   | FeaturesGeneration    |
| 11  | Тайм-аут подключения (мс)                | ![](./img/integer.svg) Целый      | 60000                 |
| 12  | Общий тайм-аут (мс)                      | ![](./img/integer.svg) Целый      | 60000                 |
| 13  | Не проверять сертификат сервера          | ![](./img/logical.svg) Логический | true                  |
| 14  | Задержка между запросами (мс)            | ![](./img/integer.svg) Целый      | 0                     |
| 15  | Количество повторных запросов при ошибке | ![](./img/integer.svg) Целый      | 0                     |
| 16  | Задержка между неудачными запросами (мс) | ![](./img/integer.svg) Целый      | 1000                  |

1. **Описание датасета** — пользовательское описание набора данных. Кратко опишите, что из себя представляет датасет и для чего он предназначен.
2. **Число признаков** — целое число, соответствующее ожидаемому числу сгенерированных новых признаков. По умолчанию `5`.
3. **Дополнительная инструкция** — пользовательская инструкция, которая будет добавлена в список требований к генерации новых признаков. Рекомендуем использовать для указания сложности генерируемых признаков.
4. **Путь к файлу** — расположение файла `llm.params`. По умолчанию в папке `credentials`.
5. **Имя файла** — имя файла, включая расширение файла, в котором указаны реквизиты и параметры. По умолчанию `llm.params`.
6. **Использовать файл** — использовать реквизиты и параметры из файла. По умолчанию `true`. При значении `false` реквизиты и параметры используются из входных портов.
7. **Запрос к Ollama** — если вы используете `Ollama API`, то необходимо указать флаг `true`. По умолчанию `false`.
8. **Формировать кэш** — если флаг `True`, то результат работы компонента будет сохранен в папку `cache` под уникальным идентификатором.
9. **Кэшированный ответ** — если флаг `True`, то вместо обращения к LLM компонент будет воспроизводить последний сохраненный результат.
10. **Уникальный идентификатор** — имя, под которым будет сохраняться результат работы текущего узла.
11. **Тайм-аут подключения (мс)**  — максимальное время установки TCP-соединения с сервером в миллисекундах, по истечении которого соединение будет прервано со статусом ошибки. Если параметр равен нулю, то таймаут не ограничен.
12. **Общий тайм-аут (мс)** — максимальное время, которое будет затрачено на отправку HTTP-запроса и получение ответа, по истечении которого обмен будет прерван со статусом ошибки. Если параметр равен нулю, то таймаут не ограничен.
13. **Не проверять сертификат сервера** — если данный флаг установлен, то ошибки при проверке сертификата сервера, к которому производится подключение, игнорируются.
14. **Задержка между запросами (мс)** — время ожидания перед каждым отдельным запросом из списка запросов.
15. **Количество повторных запросов при ошибке** — количество повторных попыток выполнения запроса при возникновении ошибки. По умолчанию `0`.
16. **Задержка между неудачными запросами (мс)** — время ожидания перед повторной попыткой выполнения запроса при возникновении ошибки.

## Выходные порты

| Название         | Тип        |
| :--------------- | :--------- |
| Список признаков | Таблица    |
| Набор данных     | Таблица    |
| Реквизиты        | Переменные |
| Сообщения        | Таблица    |

### Структура таблицы "Список признаков"

| Метка             | Тип                             | Описание |
| :---------------- | :------------------------------ | :------- |
| Имя признака      | ![](./img/string.svg) Строковый | Имя сгенерированного признака на латинице |
| Метод расчета     | ![](./img/string.svg) Строковый | Выражение, описывающее способ расчета нового признака из существующих |
| Описание признака | ![](./img/string.svg) Строковый | Обоснование полезности нового признака |

### Структура таблицы "Набор данных"

Исходный набор данных из входного порта.

### Переменные в порте "Реквизиты"

| №   | Метка   | Тип                             |
| :-- | :------ | :------------------------------ |
| 1   | url     | ![](./img/string.svg) Строковый |
| 2   | api_key | ![](./img/string.svg) Строковый |
| 3   | model   | ![](./img/string.svg) Строковый |

### Структура таблицы "Сообщения"

| Метка                  | Тип                             |
| :--------------------- | :------------------------------ |
| Идентификатор итерации | ![](./img/integer.svg) Целый    |
| Идентификатор запроса  | ![](./img/integer.svg) Целый    |
| Код завершения         | ![](./img/integer.svg) Целый    |
| Описание ошибки        | ![](./img/string.svg) Строковый |
| Код состояния HTTP     | ![](./img/integer.svg) Целый    |